YUI.add("gallery-lightbox",function(C){try{var B=function(D){B.superclass.constructor.call(this,D);};B.NAME="lightbox";B.ATTRS={selector:{value:"a[rel=lightbox]"},anim:{value:!C.Lang.isUndefined(C.Anim)},strings:{value:{closecaption:"click to close"}}};C.extend(B,C.Widget,{initializer:function(){this.set("zIndex",10000);this.publish("openLB",{defaultFn:function(){}});this.publish("closeLB",{defaultFn:function(){}});C.one("body").delegate("click",C.bind(function(D){if(this.imgnode!==undefined){this.get("contentBox").removeChild(this.imgnode);}if(this.titlenode!==undefined){this.get("contentBox").removeChild(this.titlenode);}this.fire("openLB",{src:D.currentTarget.get("href"),title:D.currentTarget.get("title")});D.preventDefault();},this),this.get("selector"));this.hide();},destructor:function(){this.imgnode=null;this.detach("*");},renderUI:function(){this.loadingImg=C.Node.create("<div class='"+this.getClassName("loading")+"'></div>");},bindUI:function(){this.after("openLB",C.bind(this._openLB,this));this.after("closeLB",C.bind(this._closeLB,this));},syncUI:function(){},_loadLB:function(){this.get("contentBox").appendChild(this.loadingImg);if(this.get("anim")){var D=new C.Anim({node:this.get("boundingBox"),from:{opacity:0},to:{opacity:1},duration:0.1});D.run();}this.show();this.set("centered",true);},_loadContent:function(D){this.titlenode=C.Node.create("<h1 class='"+this.getClassName("title")+"'>"+D.title+"</h1>");this.imgnode=C.Node.create("<img />");this.imgnode.set("title",this.get("strings").closecaption);this.imgnode.set("src",D.src);},_resizeLB:function(){var E=this.imgnode.get("offsetWidth"),G=this.imgnode.get("offsetHeight"),I=E/G;var H=this.get("boundingBox").get("offsetHeight"),D=this.get("boundingBox").get("winHeight");if(D-H<0){G+=(D-H);E+=(D-H)*I;}this.imgnode.set("width",E);this.imgnode.set("height",G);var F=this.get("boundingBox").get("offsetWidth"),J=this.get("boundingBox").get("winWidth");if(J-F<0){E+=(J-F);G+=(J-F)/I;}this.imgnode.set("width",E);this.imgnode.set("height",G);},_fromLoadToContent:function(){this.hide();this.get("contentBox").removeChild(this.loadingImg);this.get("contentBox").appendChild(this.imgnode);this.get("contentBox").appendChild(this.titlenode);if(this.get("anim")){var D=new C.Anim({node:this.get("boundingBox"),from:{opacity:0},to:{opacity:1},duration:0.5});D.on("start",C.bind(this.show,this));D.run();}else{this.show();}this._resizeLB();this.set("centered",true);},_openLB:function(D){this._loadLB();this._loadContent(D);this.imgnode.on("load",C.bind(function(){this._fromLoadToContent();},this));this.imgnode.on("click",C.bind(function(){this.fire("closeLB");},this));},_closeLB:function(E){if(this.get("anim")){var D=new C.Anim({node:this.get("boundingBox"),from:{opacity:1},to:{opacity:0},duration:0.5});D.on("end",C.bind(this.hide,this));D.run();}else{this.hide();}}});B=C.Base.build(B.NAME,B,[C.WidgetPosition,C.WidgetPositionExt,C.WidgetStack],{dynamic:false});C.Lightbox=B;}catch(A){alert(A.message);}},"@VERSION@",{requires:["widget","widget-position-ext","widget-stack","node","event"]});